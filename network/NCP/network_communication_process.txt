/*
 * author: inkXu
 * date:   2022.10.5
 *
 * 网络通信过程
 */

  网络通信概述

  通过对TCP、UDP的编程学习，能够完成对实际项目徐秋中网络功能的开发，为了提高程序的稳定性以及效率
  等，通常会使用多线程、多进程开发；根据功能需求的不同，可以利用C/S、B/S模式进行开发。
  作为嵌入式工程师，需要掌握整个网络通信的过程，从一个整体的角度来开发出更加稳定、效率高的网络程序



  网络通信过程分析软件

  Packet Tracer 

  realtime           实时
  simulation         仿真，模拟
  auto capture       自动捕获
  auto play          自动播放
  next hop           下一跳



  通信过程（PC + switch）

  交换机介绍

  网络交换机（又称”网络交换器”），是一个扩大网络的器材，可以把更多的计算机等网络设备连接到当前的
  网络中。
  具有性价比高、高度灵活、相对简单、易于实现等特点
  以太网技术已成为当今最重要的一种局域网组网技术，网络交换机也就成为了最普及的交换机
  交换机连接的主机，需要保证在同一网段内，这样才能进行通信

  交换机功能

  1) 转发过滤：当一个数据帧的目的地址在MAC地址表中有映射时，它被转发到连接目的节点的端口而不是
               所有端口（如该数据帧为广播/组播帧则转发至所有端口）
  2) 学习功能：以太网交换机了解每一端口相连设备的MAC地址，并将地址同相应的端口映射起来存放在交换
               机缓存中的MAC地址表中
  3) 目前交换机还具备了一些新的功能，如对VLAN（虚拟局域网）的支持、对链路汇聚的支持，甚至有的还
     具有防火墙的功能

  想：交换机中有一个MAC地址表，两台主机第一次通信时，交换机MAC地址表为空，当源主机不知道目的主机
      的MAC地址时，会先发送ARP广播数据包给交换机，交换机接收到后会进行广播，目的主机接收到后会回
      发ARP数据包进行应答，这时两台主机的MAC和对应的交换机端口都会写入交换机的MAC表中，PC内的ARP
      表也写入通信主机的MAC地址。下次通信时就不需要再次发送广播，交换机可以直接查看MAC表，若是这
      两台主机长时间没有进行通信，这两台主机的MAC会被清除。

  总结：
      如果PC不知目标主机所对应的MAC，那么可以看出，PC会先发送ARP广播，得到对方的MAC地址后，再进
      行数据的传送
      当switch第一次收到ARP广播数据，会把ARP广播数据包转发给所有端口（除来源端口），如果以后还有
      PC询问此IP的MAC，那么只是向目标的端口进行转发数据
      每台PC都会有一个ARP缓存表，用来记录IP所对应的MAC
  注意：arp表不是永久的，过一段时间之后就会将没有通信的主机的ip地址以及其mac地址从表中移除



  通信过程（PC+switch+router）

  路由器介绍

  路由器（Router）又称网关设备（Gateway）是用于连接多个逻辑上分开的网络
  所谓逻辑网络是代表一个单独的网络或者一个子网。当数据从一个子网传输到另外一个子网时，可通过路
  由器的路由功能来完成，路由器还具有判断网络地址和选择IP路径的功能

  路由器工作在网络层，可以实现不同网段的主机之间进行通信

  总结：
  不在同一网段的PC，需要设置默认网关才能把数据发送过去
  通常情况下，都会把路由器设置为默认网关
  当路由器收到一个其它网段的数据包时，会根据”路由表”来决定把此数据包发送到哪个端口，路由表的设置
  方法有静态和动态方法
  设置路由表就是设置下一跳，指定当前网段的主机与另一个网段主机通信时数据包应该交给哪个路由器

  配置静态路由时，有三个参数需要配置，分别是Network，Mask，Next hop，其中Network表示目的子网的网
  段，Mask子网掩码，好像只能写255.255.255.0，Net hop填写下一级路由器的IP地址，该IP地址为当前路由
  器同一网段的IP地址(路由器一般填写两个IP地址，一端是子网IP，用作网关，一端是外网IP)
  









